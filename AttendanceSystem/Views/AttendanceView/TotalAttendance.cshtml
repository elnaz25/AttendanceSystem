@model IEnumerable<AttendanceSystem.Models.Attendances>
@using AttendanceSystem.Models;
@using AttendanceSystem.Data;


@{ ViewBag.Title = "TotalAttendance";

                List<Users> users = TempData["Users"] as List<Users>;
                string StartDate = TempData["Start"] as string;
                string EndDate = TempData["End"] as string; }

<h2>Attendance</h2>


@using (Html.BeginForm())
{
@Html.AntiForgeryToken()

                <div class="row">
                    <div class="form-group">
                        <div class="col-md-12">
                            Select users
                        </div>
                    </div>
                </div>
                                <div class="row">
                                    <div class="form-group">

                                        <div class="col-md-3">
                                            @Html.DropDownList("Users",
                                                     (IEnumerable<SelectListItem>)TempData["Users"],
                                                     "All Users",
                                                     new { @class = "form-control", onchange = "this.form.submit();" })
                                        </div>
                                        <div class="col-md-3">
                                            <input id="Start" name="Start" class="form-control datapiker" placeholder="Start" value="@StartDate" />

                                        </div>
                                        <div class="col-md-3">

                                            <input class="form-control datapiker" id="End" name="End" placeholder="End" value="@EndDate" />
                                        </div>

                                        <div class="col-md-3">

                                            <input type="submit" value="Search" class="btn btn-default" />
                                        </div>


                                    </div>
                                </div>}




<table class="table" style="margin-top:10px;">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.ComingTime)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DateOfDay)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.LeaveTime)
        </th>
        <th>
            User Name
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
<tr>
    <td>
        @Html.DisplayFor(modelItem => item.ComingTime)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.DateOfDay)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.LeaveTime)
    </td>
    <td>
        @DispayUser(item.User_ID)

    </td>

    <td>


        @Html.ActionLink("Edit", "Edit", new { id = item.Attendance_ID }) |

        @Html.ActionLink("Delete", "Delete", new { id = item.Attendance_ID })
    </td>
</tr>}

</table>



@section Scripts
{
    <script type="text/javascript">$(function () {
            $(".datapiker").datetimepicker({
                format: 'd/m/Y'
            });
        });</script>
}

@helper  DispayUser(int userID)
{List<Users> users = TempData["UsersNames"] as List<Users>;
                    string username = "";

                    foreach (var E in users)
                    {

                        if (E.ID == userID)
                        {
                            username = E.FirstName + " " + E.LastName;

                        }



                    }


    <span>
        @username

    </span>


}
